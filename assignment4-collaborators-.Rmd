---
title: "Is there a relationship between the level of crime in Australia and tourism?"
author: Collaborators
output:
  pdf_document:
    citation_package: natbib
    highlight: tango
    number_sections: yes
    toc: yes
    toc_depth: 2
    keep_tex: true
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
bibliography: references.bib 
biblio-style: plainnat
subtitle: "Machine learning consultancy"
header-includes:
- \usepackage{titling}
- \pretitle{\begin{center} 
  \includegraphics[width=5in,height=6in]{Images/sam-albury-oA7MMRxTVzo-unsplash.jpg}\LARGE\\}
- \posttitle{\end{center}}
- \usepackage{fontawesome}
- \usepackage[most]{tcolorbox}
- \usepackage{xcolor}
- \usepackage{sectsty}
- \sectionfont{\color{blue}}
- \usepackage{verbatim}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
---


```{r setup}
knitr::opts_chunk$set(echo = FALSE,message = FALSE, warning = FALSE, fig.align = "center")
library(knitr)
library(kableExtra)
library(tidyverse)
library(janitor)
library(readr)
library(lubridate)
```

# Intro

\clearpage

# Methodology

\clearpage

# Data

```{r read-data, echo = FALSE}
# clean the data set
crime <- read_csv(here::here("Data", "SYB62_328_201904_Intentional Homicides and Other Crimes.csv")) %>%
  clean_names() %>%
  rename(Country_id = t12, Country = intentional_homicides_and_other_crimes, Year = x3, Series = x4, Value = x5, footnotes = x6, Source = x7)

crime_clean <- crime[-1,]

tourism <- read_csv(here::here("Data", "SYB63_176_202003_Tourist-Visitors Arrival and Expenditure.csv")) %>%
  clean_names() %>%
  rename(Country_id = t33, Country = tourist_visitor_arrivals_and_tourism_expenditure, Year = x3, Series = x4, Tourism_arr_type = x5, Tourism_arr_footnote = x6, Value = x7, Footnotes = x8, Source = x9)

tourism_clean <- tourism[-1,]
```


\clearpage

# Section 1a

```{r}

#Varsha --> focus on crime trends around the world
```

\clearpage

# Section 1b

```{r}

#Yawen --> focus on crime in Australia
```

\clearpage

# Section 2a

```{r}

#Mayunk --> focus on tourism trends around the world
```

\clearpage

# Section 2b

```{r}

#Ankush --> focus on tourism in Australia
```

\clearpage

# Relationship between Crime and Tourism - edited by Yuheng Cui 

```{r packages used in this section}
library(naniar)
library(broom)
library(rpart)
library(rpart.plot)
```


```{r vismiss, fig.cap = "missing value in crime data set"}
crime_clean_wide <- crime_clean %>%
  select(Country, Year, Series, Value) %>%
  pivot_wider(names_from = "Series", values_from = "Value")

gg_miss_var(crime_clean_wide)
```

\clearpage

```{r join-tables}
crime_wide <- crime_clean_wide %>%
  clean_names() %>%
  select(country, year, intentional_homicide_rates_per_100_000)

tour_crime <- tourism_clean %>%
  clean_names() %>%
  select(country, year, series, value) %>%
  pivot_wider(names_from = "series", values_from = "value") %>%
  inner_join(crime_wide, by = c("country", "year")) %>%
  clean_names() %>%
  rename(tour_exp_millionsusd = tourism_expenditure_millions_of_us_dollars, visitor_thousands =tourist_visitor_arrivals_thousands) %>%
  mutate(tour_exp_millionsusd = as.numeric(tour_exp_millionsusd),
         visitor_thousands = as.numeric(visitor_thousands),
         intentional_homicide_rates_per_100_000 = as.numeric(intentional_homicide_rates_per_100_000),
         year = year(as.Date(year, "%Y")))

tour_crime %>%
  head() %>%
  kable(booktabs = TRUE, caption = "tourism/crime table") %>%  
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r lm_visitor}
lm_tour_crime_1 <- lm(visitor_thousands~year +intentional_homicide_rates_per_100_000, data = tour_crime)
lm_tour_crime_2 <-lm(visitor_thousands~year +intentional_homicide_rates_per_100_000 +country, data = tour_crime)

bind_rows(model1 = glance(lm_tour_crime_1)[c(1:5)],
          model2 = glance(lm_tour_crime_2)[c(1:5)]) %>%
  kable(booktabs = TRUE, caption = "Comparison between two models") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r lm_tour_crime_resid, fig.cap = "Predicted value and Residual value (the model of visitor arrivals)"}
augment(lm_tour_crime_2, data = tour_crime) %>%
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point(alpha = 0.2) +
  xlab("Predicted value") +
  ylab("Residual value")
```



```{r lm_spending_visitor}
lm_spending_visitor1 <- lm(tour_exp_millionsusd ~ intentional_homicide_rates_per_100_000 +country + year, data = tour_crime)
lm_spending_visitor2 <- lm(tour_exp_millionsusd ~ visitor_thousands +country +year, data = tour_crime)

bind_rows(model1 = glance(lm_spending_visitor1)[c(1:5)],
          model2 = glance(lm_spending_visitor2)[c(1:5)])%>%
  kable(booktabs = TRUE, caption = "The fitness of visitor spending model") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r lm_spending_plot, fig.cap = "Predicted value and Residual value (the model of visitor spending)"}
augment(lm_spending_visitor2, tour_crime) %>%  
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point(alpha = 0.2) +
  xlab("Predicted value") +
  ylab("Residual value")
```


\clearpage

# References
