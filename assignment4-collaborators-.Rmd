---
title: "Is there a relationship between the level of crime in Australia and tourism?"
author: Collaborators
output:
  bookdown::pdf_document2:
    citation_package: natbib
    highlight: tango
    number_sections: yes
    toc: yes
    toc_depth: 2
    keep_tex: true
  html_document:
    df_print: paged
    toc: yes
    toc_depth: '2'
bibliography: references.bib 
biblio-style: plainnat
subtitle: "Machine learning consultancy"
header-includes:
- \usepackage{titling}
- \pretitle{\begin{center} 
  \includegraphics[width=5in,height=6in]{Images/sam-albury-oA7MMRxTVzo-unsplash.jpg}\LARGE\\}
- \posttitle{\end{center}}
- \usepackage{fontawesome}
- \usepackage[most]{tcolorbox}
- \usepackage{xcolor}
- \usepackage{sectsty}
- \sectionfont{\color{blue}}
- \usepackage{verbatim}
- \usepackage{fancyhdr}
- \pagestyle{fancy}
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = "center")
library(knitr)
library(kableExtra)
library(tidyverse)
library(janitor)
library(readr)
library(lubridate)
```

# Intro

\clearpage

# Methodology

\clearpage

# Data

```{r read-data}
# clean the data set
crime <- read_csv(here::here("Data", "SYB62_328_201904_Intentional Homicides and Other Crimes.csv")) %>%
  clean_names() %>%
  rename(Country_id = t12, Country = intentional_homicides_and_other_crimes, Year = x3, Series = x4, Value = x5, footnotes = x6, Source = x7)

crime_clean <- crime[-1,]

tourism <- read_csv(here::here("Data", "SYB63_176_202003_Tourist-Visitors Arrival and Expenditure.csv")) %>%
  clean_names() %>%
  rename(Country_id = t33, Country = tourist_visitor_arrivals_and_tourism_expenditure, Year = x3, Series = x4, Tourism_arr_type = x5, Tourism_arr_footnote = x6, Value = x7, Footnotes = x8, Source = x9)

tourism_clean <- tourism[-1,]
```


\clearpage

# Section 1a

```{r}

#Varsha --> focus on crime trends around the world
```

\clearpage

# Crime Offense in Australia - edited by Yawen Zhang

```{r packages used in this section}
library(readr)
library(here)
library(dplyr)
library(tidyverse)
library(gridExtra)
library(tibble)
library(readxl)
library(ggthemes)
```

```{r read-data, include = FALSE}
crime_states <- read_csv(here("Data/Book1 offenders, states and territories .csv"))
crime_sex <- read_excel(here("Data/1. offenders, australia.xlsx"))
```

# Offense in Australia Each States
```{r crime-type}
crime_type <- crime_states %>%
  rename(Offense = `Principal offence`) %>%
  filter(Offense %in% c("02 Acts intended to cause injury","08 Theft", "10 Illicit drug offences", "13 Public order offences"))
```

```{r states-offense, fig.height=10, fig.width=12, fig.cap="Frequently Offense in Australia of Each State"}
crime_type %>%
  pivot_longer(c("NSW", "Vic.", "Qld.", "SA", "WA", "Tas.", "ACT", "NT"), names_to = "States", values_to = "Rate") %>%
  ggplot(aes(x = Year, y = Rate, group = Offense, color = Offense)) +
  geom_line() +
  scale_colour_manual(values=c(`02 Acts intended to cause injury`="#FF6600", `08 Theft`="#663399", `10 Illicit drug offences`="#339999", `13 Public order offences`="#CC0033")) +
  theme(axis.title = element_text(size=17,face="bold"), axis.text = element_text(size=10)) +
  facet_wrap(~ States, ncol = 3)
```


# Australian Offense by Gender
```{r crime-by-gender}
crime_gender <- crime_sex %>%
  rename(Offense = `Principal offence`, "2009" = `2008–09`, "2010" = `2009–10`, "2011" = `2010–11`, "2012" = `2011–12`, "2013" = `2012–13`, "2014" = `2013–14`, "2015" = `2014–15`, "2016" = `2015–16`, "2017" = `2016–17`, "2018" = `2017–18`, "2019" = `2018–19`) %>%
  filter(!Offense == "Total") %>%
  pivot_longer(c("2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019"), names_to = "Year", values_to = "Rate")
```

```{r offenses-by-gender, fig.height=10, fig.width=10, fig.cap="Offenses in Each States by Genders"}
crime_gender %>%
  ggplot(aes(x = Year, y = Rate, group = Gender, color = Gender)) +
  geom_line() +
  theme(axis.text.x = element_text(size = 10, angle = 60, vjust = .5)) +
  facet_wrap(~ Offense, ncol = 3)
```


\clearpage

# Section 2a

```{r}

#Mayunk --> focus on tourism trends around the world
```

\clearpage

# Section 2b

```{r}

#Ankush --> focus on tourism in Australia
```

\clearpage

# Relationship between Crime and Tourism - edited by Yuheng Cui 

```{r packages used in this section}
library(naniar)
library(broom)
library(rpart)
library(rpart.plot)
```

In this section we try to find the relationship amongst the safety, number of visitor arrivals, and visitor spending. Figure \@ref(fig:vismiss) specifies the variables having missing values. To make our models available, we only kept the variable having least missing values. Table \@ref(tab:jointables) is the combined table of crime and tourism. There are still some missing values in the table but they are few.

```{r vismiss, fig.cap = "missing value in crime data set"}
crime_clean_wide <- crime_clean %>%
  select(Country, Year, Series, Value) %>%
  pivot_wider(names_from = "Series", values_from = "Value")

gg_miss_var(crime_clean_wide)
```

\clearpage

```{r jointables}
crime_wide <- crime_clean_wide %>%
  clean_names() %>%
  select(country, year, intentional_homicide_rates_per_100_000)

tour_crime <- tourism_clean %>%
  clean_names() %>%
  select(country, year, series, value) %>%
  pivot_wider(names_from = "series", values_from = "value") %>%
  inner_join(crime_wide, by = c("country", "year")) %>%
  clean_names() %>%
  rename(tour_exp_millionsusd = tourism_expenditure_millions_of_us_dollars, visitor_thousands =tourist_visitor_arrivals_thousands) %>%
  mutate(tour_exp_millionsusd = as.numeric(tour_exp_millionsusd),
         visitor_thousands = as.numeric(visitor_thousands),
         intentional_homicide_rates_per_100_000 = as.numeric(intentional_homicide_rates_per_100_000),
         year = year(as.Date(year, "%Y")))

tour_crime %>%
  head() %>%
  kable(booktabs = TRUE, caption = "tourism/crime table") %>%  
  kable_styling(bootstrap_options = c("striped", "hover"))
```

We created two linear models of visitor arrivals: one model used country as one of the explanatory variables while the other did not. In Table \ref(tab:lm_visitor), we can see much higher $R^2$ of the model with country, which had $R^2$ of 97.5%. That is, 97.5% of the variation of the explanatory variables can be explained by the model. In sum, country had the absolute influence. That is, holding crime rate and year constant, some countries were more attractive to tourists. This is true, because some countries have more landmarks and viewpoints than other countries.

```{r lmvisitor}
lm_tour_crime_1 <- lm(visitor_thousands~year +intentional_homicide_rates_per_100_000, data = tour_crime)
lm_tour_crime_2 <-lm(visitor_thousands~year +intentional_homicide_rates_per_100_000 +country, data = tour_crime)

bind_rows(model1 = glance(lm_tour_crime_1)[c(1:2)],
          model2 = glance(lm_tour_crime_2)[c(1:2)]) %>%
  rowid_to_column()%>%
  rename(model = rowid) %>%
  kable(booktabs = TRUE, caption = "Comparison between two models") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r lmtourcrimeresid, fig.cap = "Predicted value and Residual value (the model of visitor arrivals)"}
augment(lm_tour_crime_2, data = tour_crime) %>%
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point(alpha = 0.2) +
  xlab("Predicted value") +
  ylab("Residual value")
```



```{r lmspendingvisitor}
lm_spending_visitor1 <- lm(tour_exp_millionsusd ~ intentional_homicide_rates_per_100_000 +country + year, data = tour_crime)
lm_spending_visitor2 <- lm(tour_exp_millionsusd ~ visitor_thousands +country +year, data = tour_crime)
lm_spending_visitor3 <- lm(tour_exp_millionsusd ~ intentional_homicide_rates_per_100_000 + visitor_thousands +country +year, data = tour_crime)

bind_rows(model1 = glance(lm_spending_visitor1)[c(1:2)],
          model2 = glance(lm_spending_visitor2)[c(1:2)],
          model3 = glance(lm_spending_visitor3)[c(1:2)]) %>%
  rowid_to_column()%>%
  rename(model = rowid)%>%
  kable(booktabs = TRUE, caption = "The fitness of visitor spending model") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r lmspendingplot, fig.cap = "Predicted value and Residual value (the model of visitor spending)"}
augment(lm_spending_visitor2, tour_crime) %>%  
  ggplot(aes(x = .fitted, 
             y = .resid)) +
  geom_point(alpha = 0.2) +
  xlab("Predicted value") +
  ylab("Residual value")
```


\clearpage

# References
